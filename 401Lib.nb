(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46217,       1354]
NotebookOptionsPosition[     43262,       1296]
NotebookOutlinePosition[     43659,       1312]
CellTagsIndexPosition[     43616,       1309]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Package Imports", "Section",ExpressionUUID->"148603ca-afa5-4de7-af9d-d9b369132d9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "MaTeX`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "Notation`"}], ";"}]}], "Input",
 CellLabel->"In[51]:=",ExpressionUUID->"f447015f-2921-4084-a083-6ba388c43702"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Notation", "Section",ExpressionUUID->"d270d68a-4df6-46c6-a2ba-77003419f133"],

Cell["\<\
Symbolizes every subscripted variable (Warning this breaks functions like \
TraditionalForm and TeXForm)\
\>", "Text",ExpressionUUID->"847b9362-825f-4c58-a80a-4660fde0f8d3"],

Cell[BoxData[
 RowBox[{"Symbolize", "[", 
  TemplateBox[{
    SubscriptBox["_", "_"]},
   "NotationTemplateTag"], "]"}]], "Input",
 CellChangeTimes->{3.7967493093930283`*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"27449c4d-f273-4998-95e3-bf663a84515d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assumptions", "Section",ExpressionUUID->"6e1d76f0-ead7-41b5-9b44-1313fa88cb2f"],

Cell[TextData[{
 "Default assumption is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "0"], " ", "and", " ", 
    SubscriptBox["B", "0"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0931381e-3fab-4519-b494-0f11934b6766"],
 " are real. Use the commented line to avoid issues."
}], "Text",
 CellChangeTimes->{{3.7967613627368813`*^9, 3.7967613827508163`*^9}, {
  3.796761419785001*^9, 
  3.796761425610476*^9}},ExpressionUUID->"c5c0bd62-dbd6-44d7-86ba-\
078b181c7e63"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Gamma]", ",", "\[Beta]", ",", "r", ",", "\[Theta]", ",", "\[Phi]", 
        ",", "t", ",", "\[Tau]", ",", "R", ",", "\[Omega]", ",", "k", ",", 
        "\[Epsilon]", ",", "\[Mu]", ",", "\[Sigma]", ",", 
        SubscriptBox["\[Mu]", "0"], ",", 
        SubscriptBox["\[Epsilon]", "0"], ",", "c", ",", "v", ",", 
        SubscriptBox["N", "e"], ",", "q", ",", "L", ",", "a", ",", "b"}], 
       "}"}], "\[Element]", 
      TemplateBox[{},
       "PositiveReals"]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z", ",", 
        SubscriptBox["E", "0"], ",", 
        SubscriptBox["B", "0"]}], "}"}], "\[Element]", 
      TemplateBox[{},
       "Reals"]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n", ",", "k"}], "}"}], "\[Element]", 
      TemplateBox[{},
       "NonNegativeIntegers"]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Gamma]", ",", "\[Beta]", ",", "r", ",", "\[Theta]", ",", "\[Phi]",
           ",", "t", ",", "\[Tau]", ",", "R", ",", "\[Omega]", ",", "k", ",", 
          "\[Epsilon]", ",", "\[Mu]", ",", "\[Sigma]", ",", 
          SubscriptBox["\[Mu]", "0"], ",", 
          SubscriptBox["\[Epsilon]", "0"], ",", "c", ",", "v"}], "}"}], 
        "\[Element]", 
        TemplateBox[{},
         "PositiveReals"]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", 
        TemplateBox[{},
         "Reals"]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "n", ",", "k"}], "}"}], "\[Element]", 
        TemplateBox[{},
         "NonNegativeIntegers"]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["E", "0"], ",", 
          SubscriptBox["B", "0"]}], "}"}], "\[Element]", 
        TemplateBox[{},
         "Complexes"]}]}], "}"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.7967490103162937`*^9, {3.7967490835214148`*^9, 3.796749083777546*^9}, 
   3.796749306846477*^9, {3.796761306971232*^9, 3.796761355911498*^9}, {
   3.796761694904097*^9, 3.79676169697782*^9}, {3.796761879785276*^9, 
   3.796761882035644*^9}, {3.79676868747116*^9, 3.796768687747981*^9}, {
   3.7967719355920467`*^9, 3.796771936053784*^9}},
 CellLabel->
  "In[480]:=",ExpressionUUID->"682bd402-0904-4cab-913c-29d8857dd1ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constants", "Section",ExpressionUUID->"5eebf3cf-6400-45c1-8e94-ed0ac6a9c8a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fundamentalConstants", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", "\[Rule]", 
      RowBox[{"Quantity", "[", 
       RowBox[{"1", ",", "\"\<ElementaryCharge\>\""}], "]"}]}], ",", 
     RowBox[{
      SubscriptBox["\[Mu]", "0"], "\[Rule]", 
      RowBox[{"Quantity", "[", 
       RowBox[{"1", ",", "\"\<MagneticConstant\>\""}], "]"}]}], ",", 
     RowBox[{"c", "\[Rule]", 
      RowBox[{"Quantity", "[", 
       RowBox[{"1", ",", "\"\<SpeedOfLight\>\""}], "]"}]}], ",", 
     RowBox[{
      SubscriptBox["m", "e"], "\[Rule]", 
      RowBox[{"Quantity", "[", 
       RowBox[{"1", ",", "\"\<ElectronMass\>\""}], "]"}]}], ",", 
     RowBox[{"g", "\[Rule]", 
      RowBox[{"Quantity", "[", 
       RowBox[{"1", ",", "\"\<Gravs\>\""}], "]"}]}], ",", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "0"], "\[Rule]", 
      RowBox[{"Quantity", "[", 
       RowBox[{"1", ",", "\"\<ElectricConstant\>\""}], "]"}]}], ",", 
     RowBox[{
      SubscriptBox["m", "p"], "\[Rule]", 
      RowBox[{"Quantity", "[", 
       RowBox[{"1", ",", "\"\<ProtonMass\>\""}], "]"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.79674902665418*^9, 3.796749304155937*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"2cd2c22e-a8bf-4d99-858b-1ec133a82d5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Functions", "Section",ExpressionUUID->"29409550-0305-4b15-abee-29b598f57f03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TimeAverage", "[", "expr_", "]"}], ":=", 
  FractionBox[
   RowBox[{"\[Omega]", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
     RowBox[{"expr", 
      RowBox[{"\[DifferentialD]", "t"}]}]}]}], 
   RowBox[{"2", " ", "\[Pi]"}]]}], "\n", 
 RowBox[{
  RowBox[{"CartesianBasis", "=", 
   RowBox[{"OverHat", "/@", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SphericalBasis", "=", 
   RowBox[{"OverHat", "/@", 
    RowBox[{"{", 
     RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CartesianToSphericalField", "[", "field_", "]"}], ":=", 
  RowBox[{"TransformedField", "[", 
   RowBox[{
    RowBox[{"\"\<Cartesian\>\"", "\[Rule]", "\"\<Spherical\>\""}], ",", 
    "field", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SphericalToCartesianField", "[", "field_", "]"}], ":=", 
  RowBox[{"TransformedField", "[", 
   RowBox[{
    RowBox[{"\"\<Spherical\>\"", "\[Rule]", "\"\<Cartesian\>\""}], ",", 
    "field", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SphericalIntegral", "[", "expr_", "]"}], ":=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "\[Pi]"], 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", 
     RowBox[{"2", " ", "\[Pi]"}]], 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "2"], " ", "expr", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
     RowBox[{"\[DifferentialD]", "\[Phi]"}], 
     RowBox[{"\[DifferentialD]", "\[Theta]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"QuantityReplace", "[", 
    RowBox[{
     RowBox[{"quants_", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"Fun", "\[Rule]", "True"}], "}"}], "]"}]}], "]"}], "[", 
   "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"expr", "/.", "\[VeryThinSpace]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"QuantityQ", "[", 
         RowBox[{"qq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          "]"}], ",", 
        RowBox[{
         RowBox[{"qq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "\[Rule]", 
         RowBox[{
         "qq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
        
        RowBox[{"StringQ", "[", 
         RowBox[{"qq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          "]"}], ",", 
        RowBox[{
         RowBox[{"qq", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "\[Rule]", 
         RowBox[{"Quantity", "[", 
          RowBox[{
          "qq", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}]}], ",", "True", ",", "qq"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"qq", ",", "quants"}], "}"}]}], "]"}]}], "/.", 
   "\[VeryThinSpace]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Fun", "]"}], ",", "fundamentalConstants", 
     ",", 
     RowBox[{"{", "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"PoyntingVector", "[", 
   RowBox[{"ef_", ",", "bf_", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<fix\>\"", "\[Rule]", "True"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Re", "[", 
       RowBox[{"ComplexExpand", "[", "ef", "]"}], "]"}], "]"}], "\[Cross]", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Re", "[", 
       RowBox[{"ComplexExpand", "[", "bf", "]"}], "]"}], "]"}]}], 
    SubscriptBox["\[Mu]", "0"]], "/.", "\[VeryThinSpace]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"OptionValue", "[", "\"\<fix\>\"", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Re", "[", "x_", "]"}], "\[Rule]", "x"}], ",", 
       RowBox[{
        RowBox[{"Im", "[", "x_", "]"}], "\[Rule]", "0"}]}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"ToExplicitCartesianVector", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "/.", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      OverscriptBox["x", "^"], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
     RowBox[{
      OverscriptBox["y", "^"], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
     RowBox[{
      OverscriptBox["z", "^"], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "}"}]}]}], "\n", 
 RowBox[{
  RowBox[{"EToBFeild", "[", "ef_", "]"}], ":=", 
  RowBox[{"\[Integral]", 
   RowBox[{
    RowBox[{"-", 
     TemplateBox[{"ef", 
       RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]},
      "Curl"]}], 
    RowBox[{"\[DifferentialD]", "t"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"CircularlyPolarizedEField", "=", 
   FractionBox[
    RowBox[{
     SubscriptBox["E", "0"], " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "\[ImaginaryI]"}], "}"}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k", " ", "x"}], "-", 
         RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}]]}], 
    SqrtBox["2"]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"UnPolarizedEField", "=", 
   RowBox[{
    FractionBox[
     SubscriptBox["E", "0"], 
     SqrtBox["2"]], " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", " ", "x"}], "-", 
        RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.796749288738111*^9, 3.796749296216097*^9}, {
  3.796778034550006*^9, 3.796778080302577*^9}, {3.796778641808477*^9, 
  3.796778670770852*^9}, {3.7967787184134903`*^9, 3.796778718743105*^9}, {
  3.796780174014021*^9, 3.796780174858345*^9}, {3.796780718781107*^9, 
  3.7967807291862917`*^9}, {3.7967812280652933`*^9, 3.7967812372712593`*^9}},
 CellLabel->
  "In[617]:=",ExpressionUUID->"1b65244c-5cba-401c-8046-ae2594e26bef"]
}, Open  ]],

Cell["Optics", "Section",ExpressionUUID->"39495de2-a22f-4e06-b36c-f8ec20ca0f4a"],

Cell[CellGroupData[{

Cell["Conductors", "Section",ExpressionUUID->"04605bf3-f9e4-4fe2-a5ab-8fef139fb025"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"KCond", "=", 
   SqrtBox[
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "0"], " ", "\[Epsilon]", " ", 
      SuperscriptBox["\[Omega]", "2"]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Mu]", "0"], " ", "\[Sigma]", " ", "\[Omega]"}]}]]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"kCond", "=", 
   RowBox[{"\[Omega]", " ", 
    SqrtBox[
     FractionBox[
      RowBox[{
       SubscriptBox["\[Mu]", "0"], " ", "\[Epsilon]"}], "2"]], " ", 
    SqrtBox[
     RowBox[{
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["\[Sigma]", 
           RowBox[{"\[Epsilon]", " ", "\[Omega]"}]], ")"}], "2"]}]], "+", 
      "1"}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dCondInv", "=", 
   RowBox[{"\[Omega]", " ", 
    SqrtBox[
     FractionBox[
      RowBox[{
       SubscriptBox["\[Mu]", "0"], " ", "\[Epsilon]"}], "2"]], " ", 
    SqrtBox[
     RowBox[{
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["\[Sigma]", 
           RowBox[{"\[Epsilon]", " ", "\[Omega]"}]], ")"}], "2"]}]], "-", 
      "1"}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"bCond", "=", 
   FractionBox[
    RowBox[{"c", " ", 
     SqrtBox[
      RowBox[{"\[Epsilon]", " ", 
       SubscriptBox["\[Mu]", "0"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SqrtBox[
           RowBox[{"1", "+", 
            FractionBox[
             SuperscriptBox["\[Sigma]", "2"], 
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SuperscriptBox["\[Omega]", "2"]}]]}]]}]]}], "+", 
       SqrtBox[
        RowBox[{"1", "+", 
         SqrtBox[
          RowBox[{"1", "+", 
           FractionBox[
            SuperscriptBox["\[Sigma]", "2"], 
            RowBox[{
             SuperscriptBox["\[Epsilon]", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}]]}]]}]]}], ")"}]}], 
    RowBox[{
     SqrtBox["2"], " ", "n"}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RFCond", "=", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["n", "2"], " ", "\[Omega]"}], "-", 
     RowBox[{
      SuperscriptBox["c", "2"], " ", 
      SubscriptBox["\[Mu]", "0"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SuperscriptBox["\[Omega]", "2"]}]}]]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox["2"], " ", "c", " ", "n", " ", 
      SqrtBox[
       RowBox[{
        SubscriptBox["\[Mu]", "0"], " ", "\[Omega]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]"}], " ", "\[Omega]"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "+", 
            RowBox[{
             SuperscriptBox["\[Epsilon]", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}]}]]}], ")"}]}]]}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["n", "2"], " ", "\[Omega]"}], "+", 
     RowBox[{
      SuperscriptBox["c", "2"], " ", 
      SubscriptBox["\[Mu]", "0"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SuperscriptBox["\[Omega]", "2"]}]}]]}], "+", 
     RowBox[{
      SqrtBox["2"], " ", "c", " ", "n", " ", 
      SqrtBox[
       RowBox[{
        SubscriptBox["\[Mu]", "0"], " ", "\[Omega]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]", " ", "\[Omega]"}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "+", 
            RowBox[{
             SuperscriptBox["\[Epsilon]", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}]}]]}], ")"}]}]]}]}]]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"TFCond", "=", 
   FractionBox[
    RowBox[{"4", " ", "n"}], 
    RowBox[{
     RowBox[{"2", " ", "n"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          RowBox[{"\[Epsilon]", " ", 
           SubscriptBox["\[Mu]", "0"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SqrtBox[
              RowBox[{"1", "+", 
               FractionBox[
                SuperscriptBox["\[Sigma]", "2"], 
                RowBox[{
                 SuperscriptBox["\[Epsilon]", "2"], " ", 
                 SuperscriptBox["\[Omega]", "2"]}]]}]]}], ")"}]}]]}], "+", 
        SqrtBox[
         RowBox[{"\[Epsilon]", " ", 
          SubscriptBox["\[Mu]", "0"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SqrtBox[
             RowBox[{"1", "+", 
              FractionBox[
               SuperscriptBox["\[Sigma]", "2"], 
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SuperscriptBox["\[Omega]", "2"]}]]}]]}], ")"}]}]]}], 
       ")"}]}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RCfCond", "=", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["n", "4"], " ", 
      SuperscriptBox["\[Omega]", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["c", "2"], " ", 
      SuperscriptBox["n", "2"], " ", "\[Epsilon]", " ", 
      SubscriptBox["\[Mu]", "0"], " ", 
      SuperscriptBox["\[Omega]", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["c", "4"], " ", 
      SubsuperscriptBox["\[Mu]", "0", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["n", "2"], " ", "\[Omega]"}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["\[Mu]", "0"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["\[Sigma]", "2"], "+", 
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           SuperscriptBox["\[Omega]", "2"]}]}]]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", "c", " ", "n", " ", 
        SqrtBox[
         RowBox[{
          SubscriptBox["\[Mu]", "0"], " ", "\[Omega]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]", " ", "\[Omega]"}], "+", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["\[Sigma]", "2"], "+", 
              RowBox[{
               SuperscriptBox["\[Epsilon]", "2"], " ", 
               SuperscriptBox["\[Omega]", "2"]}]}]]}], ")"}]}]]}]}], ")"}], 
     "2"]]}], ";"}]}], "Input",
 CellChangeTimes->{3.796749031113071*^9, 3.796749315608178*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"924bfec1-24c6-41a9-9b89-b7f619589cc9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plasma", "Section",ExpressionUUID->"6483b942-e66c-4021-b1d2-c7357791be13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PlasmaFrequency", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SubscriptBox["N", "e"], 
     FractionBox[
      SuperscriptBox["q", "2"], 
      RowBox[{"m", " ", 
       SubscriptBox["\[Epsilon]", "0"]}]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KPlasma", "=", 
    FractionBox[
     RowBox[{"Sqrt", "[", 
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], "-", 
       SuperscriptBox["PlasmaFrequency", "2"]}], "]"}], 
     SuperscriptBox["c", "2"]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlasmaConductivity", "=", 
   RowBox[{"I", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       SubscriptBox["N", "e"], 
       SuperscriptBox["q", "2"]}]}], 
     RowBox[{"m", " ", "\[Omega]"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.796761907140684*^9, 
  3.796761907871805*^9}},ExpressionUUID->"8330c43b-4e55-4c23-bb27-\
e658a7e66e49"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transmission Lines", "Section",ExpressionUUID->"b0aef000-fd17-457f-9bfa-f45b2360b5a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Do", " ", "not", " ", "symbolize", " ", "these", " ", "subscripts"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CutOffFrequencyTable", "[", 
     RowBox[{
      RowBox[{"nmax_", ":", "3"}], ",", 
      RowBox[{"mmax_", ":", "3"}]}], "]"}], ":=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"f", ",", "m", ",", "n"}], "]"}], "\[Equal]", 
        "CutOffFrequency"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", "nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0", ",", "mmax"}], "}"}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CutOffAngularFrequencyTable", "[", 
     RowBox[{
      RowBox[{"nmax_", ":", "3"}], ",", 
      RowBox[{"mmax_", ":", "3"}]}], "]"}], ":=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Omega]", ",", "m", ",", "n"}], "]"}], "\[Equal]", 
        "CutOffAngularFrequency"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", "nmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0", ",", "mmax"}], "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.796778265505474*^9, 3.796778288592931*^9}},
 CellLabel->
  "In[469]:=",ExpressionUUID->"829588c5-8262-4002-9799-3bef3940b580"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CutOffAngularFrequency", "=", 
   RowBox[{"v", " ", "\[Pi]", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["m", "a"], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["n", "b"], ")"}], "2"]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CutOffFrequency", "=", 
   RowBox[{
    FractionBox["1", "2"], " ", "v", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["m", "a"], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["n", "b"], ")"}], "2"]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TMBz", "=", 
   RowBox[{
    SubscriptBox["B", "0"], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", " ", "z"}], "-", 
        RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TEEz", "=", 
   RowBox[{
    SubscriptBox["E", "0"], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k", " ", "z"}], "-", 
        RowBox[{"\[Omega]", " ", "t"}]}], ")"}]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TEModeEField", ",", "TEModeBField"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", " ", "z"}], "-", 
             RowBox[{"t", " ", "\[Omega]"}]}], ")"}]}]], " ", 
         SubscriptBox["E", "0"], " ", "k", " ", "m", " ", "\[Pi]", " ", 
         SuperscriptBox["v", "2"], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}]}], 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], " ", 
            SuperscriptBox["v", "2"]}], "+", 
           SuperscriptBox["\[Omega]", "2"]}], ")"}]}]], ",", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", " ", "z"}], "-", 
             RowBox[{"t", " ", "\[Omega]"}]}], ")"}]}]], " ", 
         SubscriptBox["E", "0"], " ", "k", " ", "n", " ", "\[Pi]", " ", 
         SuperscriptBox["v", "2"], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}]}], 
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], " ", 
            SuperscriptBox["v", "2"]}], "+", 
           SuperscriptBox["\[Omega]", "2"]}], ")"}]}]], ",", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", "z"}], "-", 
            RowBox[{"t", " ", "\[Omega]"}]}], ")"}]}]], " ", 
        SubscriptBox["E", "0"], " ", 
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}]}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "k", " ", "z"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]}]], " ", 
         SubscriptBox["E", "0"], " ", "n", " ", "\[Pi]", " ", "\[Omega]", " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}]}], 
        RowBox[{
         RowBox[{"b", " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{"b", " ", 
          SuperscriptBox["\[Omega]", "2"]}]}]], ",", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", " ", "z"}], "-", 
             RowBox[{"t", " ", "\[Omega]"}]}], ")"}]}]], " ", 
         SubscriptBox["E", "0"], " ", "m", " ", "\[Pi]", " ", "\[Omega]", " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}]}], 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], " ", 
            SuperscriptBox["v", "2"]}], "+", 
           SuperscriptBox["\[Omega]", "2"]}], ")"}]}]], ",", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TMModeEField", ",", "TMModeBField"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["B", "0"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "k", " ", "z"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]}]], " ", "n", 
         " ", "\[Pi]", " ", 
         SuperscriptBox["v", "2"], " ", "\[Omega]", " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}]}], 
        RowBox[{
         RowBox[{"b", " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{"b", " ", 
          SuperscriptBox["\[Omega]", "2"]}]}]], ",", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["B", "0"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k", " ", "z"}], "-", 
             RowBox[{"t", " ", "\[Omega]"}]}], ")"}]}]], " ", "m", " ", 
         "\[Pi]", " ", 
         SuperscriptBox["v", "2"], " ", "\[Omega]", " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}]}], 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["k", "2"]}], " ", 
            SuperscriptBox["v", "2"]}], "+", 
           SuperscriptBox["\[Omega]", "2"]}], ")"}]}]], ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["B", "0"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "k", " ", "z"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]}]], " ", "k", 
         " ", "m", " ", "\[Pi]", " ", 
         SuperscriptBox["v", "2"], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}]}], 
        RowBox[{
         RowBox[{"a", " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{"a", " ", 
          SuperscriptBox["\[Omega]", "2"]}]}]], ",", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["B", "0"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "k", " ", "z"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", "t", " ", "\[Omega]"}]}]], " ", "k", 
         " ", "n", " ", "\[Pi]", " ", 
         SuperscriptBox["v", "2"], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}], " ", 
         RowBox[{"Sin", "[", 
          FractionBox[
           RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}]}], 
        RowBox[{
         RowBox[{"b", " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{"b", " ", 
          SuperscriptBox["\[Omega]", "2"]}]}]], ",", 
       RowBox[{
        SubscriptBox["B", "0"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", "z"}], "-", 
            RowBox[{"t", " ", "\[Omega]"}]}], ")"}]}]], " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"m", " ", "\[Pi]", " ", "x"}], "a"], "]"}], " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"n", " ", "\[Pi]", " ", "y"}], "b"], "]"}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"KRectWaveguide", "=", 
   FractionBox[
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Omega]", "2"], "-", 
      SuperscriptBox["CutOffAngularFrequency", "2"]}]], "v"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KRectGroupVelocity", "=", 
   FractionBox[
    RowBox[{"v", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], "-", 
       SubsuperscriptBox["\[Omega]", "c", "2"]}]]}], "\[Omega]"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KRectWaveguideCutOffForm", "=", 
   FractionBox[
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Omega]", "2"], "-", 
      SubsuperscriptBox["\[Omega]", "c", "2"]}]], "v"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntegrateOverRectangularWaveguide", "[", "expr_", "]"}], ":=", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "a"], 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", "b"], 
    RowBox[{"expr", 
     RowBox[{"\[DifferentialD]", "y"}], 
     RowBox[{"\[DifferentialD]", "x"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.796760432841606*^9, 3.7967604404911222`*^9}, {
   3.796760579339121*^9, 3.796760579591154*^9}, {3.7967612094411793`*^9, 
   3.796761209832947*^9}, {3.7967615200828123`*^9, 3.796761608128233*^9}, 
   3.7967619143466787`*^9, {3.79677148509359*^9, 3.796771485407257*^9}, 
   3.7967716670456753`*^9, {3.796773837744461*^9, 3.796773838007601*^9}},
 CellLabel->
  "In[418]:=",ExpressionUUID->"3b023b5c-1a3b-4f58-bba0-bed4fbb796d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dipoles", "Section",ExpressionUUID->"4910ecc9-7d52-45df-b262-b0f8b174eb2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DipoleEField", "[", "p_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SubscriptBox["\[Mu]", "0"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ".", 
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "2"}], "}"}]], "p"}]}], " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
       SuperscriptBox["r", "2"]], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]], "p"}]}], ")"}]}], 
   RowBox[{"4", " ", "\[Pi]", " ", "r"}]]}], "\n", 
 RowBox[{
  RowBox[{"DipoleBField", "[", "p_", "]"}], ":=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SubscriptBox["\[Mu]", "0"], " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Cross]", 
      RowBox[{
       SubscriptBox["\[PartialD]", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]], "p"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", " ", "\[Pi]", " ", "r", " ", "c"}], ")"}], " ", 
     "r"}]]}]}], "\n", 
 RowBox[{
  RowBox[{"DipolePoyntingVector", "[", "p_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SubscriptBox["\[Mu]", "0"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"4", " ", "\[Pi]", " ", "r"}]], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Total", "[", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"{", 
            RowBox[{"t", ",", "2"}], "}"}]], "p"}], ")"}], "2"], "]"}], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ".", 
          RowBox[{
           SubscriptBox["\[PartialD]", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]], "p"}]}], "r"], ")"}], "2"]}], 
     ")"}], " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
   RowBox[{"c", " ", "r"}]]}]}], "Input",
 CellChangeTimes->{3.796749103548731*^9, 3.796749319027225*^9},
 CellLabel->"In[71]:=",ExpressionUUID->"78d6985f-f23b-4dc4-b9da-7da5968dd344"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relativity", "Section",ExpressionUUID->"ad09bb25-39da-40f2-ad30-5d56cfd05fe4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BetaToGamma", "[", "\[Beta]_", "]"}], ":=", 
  FractionBox["1", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["\[Beta]", "2"]}]]]}], "\n", 
 RowBox[{
  RowBox[{"GammaToBeta", "[", "\[Gamma]_", "]"}], ":=", 
  SqrtBox[
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[Gamma]", "2"]}], 
    SuperscriptBox["\[Gamma]", "2"]]]}], "\n", 
 RowBox[{
  RowBox[{"FieldTensor", "[", 
   RowBox[{"e_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"#1", "-", 
        RowBox[{"Transpose", "[", "#1", "]"}]}], "&"}], ")"}], "[", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "n_"}], "}"}], "/;", 
           RowBox[{"n", ">", "1"}]}], "\[Rule]", 
          FractionBox[
           RowBox[{"e", "\[LeftDoubleBracket]", 
            RowBox[{"n", "-", "1"}], "\[RightDoubleBracket]"}], "c"]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "n_"}], "}"}], "/;", 
           RowBox[{"n", ">", "2"}]}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{"7", "-", 
             RowBox[{"2", " ", "n"}]}], "]"}], " ", 
           RowBox[{"b", "\[LeftDoubleBracket]", 
            RowBox[{"6", "-", "n"}], "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", 
          RowBox[{
          "b", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"EfieldExtract", "[", "F_", "]"}], ":=", 
  RowBox[{"c", " ", 
   RowBox[{"F", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", 
     RowBox[{"2", ";;", "All"}]}], "\[RightDoubleBracket]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"BfieldExtract", "[", "F_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"F", "\[LeftDoubleBracket]", 
     RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"-", 
     RowBox[{"F", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}]}], ",", 
    RowBox[{"F", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"LorentzTensor", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Gamma]", ",", 
       RowBox[{
        RowBox[{"-", "\[Beta]"}], " ", "\[Gamma]"}], ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Beta]"}], " ", "\[Gamma]"}], ",", "\[Gamma]", ",", 
       "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"LorentzTensorBeta", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Beta]", "2"]}]]], ",", 
       RowBox[{"-", 
        FractionBox["\[Beta]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[Beta]", "2"]}]]]}], ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Beta]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[Beta]", "2"]}]]]}], ",", 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Beta]", "2"]}]]], ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"FieldTensorLorentzTransformation", "[", 
   RowBox[{"F_", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<BetaOnly\>\"", "\[Rule]", "True"}], "}"}], "]"}]}], "]"}], 
  ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"OptionValue", "[", "\"\<BetaOnly\>\"", "]"}], ",", 
    RowBox[{"Simplify", "[", 
     RowBox[{"LorentzTensorBeta", ".", "F", ".", "LorentzTensorBeta"}], "]"}],
     ",", 
    RowBox[{"Simplify", "[", 
     RowBox[{"LorentzTensor", ".", "F", ".", "LorentzTensor"}], "]"}]}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"changeFrame", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      RowBox[{"\[Gamma]", " ", 
       RowBox[{"(", 
        RowBox[{
         OverscriptBox["x", "_"], "+", 
         RowBox[{"v", " ", 
          OverscriptBox["t", "_"]}]}], ")"}]}]}], ",", 
     RowBox[{"t", "\[Rule]", 
      RowBox[{"\[Gamma]", 
       RowBox[{"(", 
        RowBox[{
         OverscriptBox["t", "_"], "+", 
         FractionBox[
          RowBox[{"\[Beta]", " ", 
           OverscriptBox["x", "_"]}], "c"]}], ")"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"betaToGammaRule", "=", 
   RowBox[{"{", 
    RowBox[{"\[Beta]", "\[Rule]", 
     RowBox[{"GammaToBeta", "[", "\[Gamma]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gammaToBetaRule", "=", 
   RowBox[{"{", 
    RowBox[{"\[Gamma]", "\[Rule]", 
     RowBox[{"BetaToGamma", "[", "\[Beta]", "]"}]}], "}"}]}], ";"}]}], "Input",\

 CellChangeTimes->{
  3.7967493216250553`*^9, {3.796749705042346*^9, 3.796749707000864*^9}, {
   3.796778511087647*^9, 3.796778516202016*^9}, {3.796781315231022*^9, 
   3.7967813242771797`*^9}, {3.7967813727329206`*^9, 3.796781415964329*^9}, {
   3.796782026440987*^9, 3.796782077995726*^9}, {3.796782141663308*^9, 
   3.796782144601262*^9}, {3.796782177578793*^9, 3.79678217778878*^9}},
 CellLabel->
  "In[668]:=",ExpressionUUID->"0bcafeda-ba2b-4bb2-b284-13a426ca809c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7967820936234293`*^9, 
  3.7967821766744823`*^9}},ExpressionUUID->"1ce70016-49cd-4a23-9309-\
21064334b28e"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{316, Automatic}, {Automatic, 50}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c3696e67-8e09-4a57-ad00-3392170b82f3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 89, 0, 67, "Section",ExpressionUUID->"148603ca-afa5-4de7-af9d-d9b369132d9b"],
Cell[672, 24, 204, 5, 52, "Input",ExpressionUUID->"f447015f-2921-4084-a083-6ba388c43702"]
}, Open  ]],
Cell[CellGroupData[{
Cell[913, 34, 82, 0, 67, "Section",ExpressionUUID->"d270d68a-4df6-46c6-a2ba-77003419f133"],
Cell[998, 36, 183, 3, 35, "Text",ExpressionUUID->"847b9362-825f-4c58-a80a-4660fde0f8d3"],
Cell[1184, 41, 253, 6, 41, "Input",ExpressionUUID->"27449c4d-f273-4998-95e3-bf663a84515d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1474, 52, 85, 0, 67, "Section",ExpressionUUID->"6e1d76f0-ead7-41b5-9b44-1313fa88cb2f"],
Cell[1562, 54, 512, 14, 35, "Text",ExpressionUUID->"c5c0bd62-dbd6-44d7-86ba-078b181c7e63"],
Cell[2077, 70, 2609, 70, 53, "Input",ExpressionUUID->"682bd402-0904-4cab-913c-29d8857dd1ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4723, 145, 83, 0, 67, "Section",ExpressionUUID->"5eebf3cf-6400-45c1-8e94-ed0ac6a9c8a9"],
Cell[4809, 147, 1276, 32, 56, "Input",ExpressionUUID->"2cd2c22e-a8bf-4d99-858b-1ec133a82d5d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6122, 184, 91, 0, 67, "Section",ExpressionUUID->"29409550-0305-4b15-abee-29b598f57f03"],
Cell[6216, 186, 6565, 187, 452, "Input",ExpressionUUID->"1b65244c-5cba-401c-8046-ae2594e26bef"]
}, Open  ]],
Cell[12796, 376, 80, 0, 67, "Section",ExpressionUUID->"39495de2-a22f-4e06-b36c-f8ec20ca0f4a"],
Cell[CellGroupData[{
Cell[12901, 380, 84, 0, 53, "Section",ExpressionUUID->"04605bf3-f9e4-4fe2-a5ab-8fef139fb025"],
Cell[12988, 382, 6974, 219, 462, "Input",ExpressionUUID->"924bfec1-24c6-41a9-9b89-b7f619589cc9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19999, 606, 80, 0, 67, "Section",ExpressionUUID->"6483b942-e66c-4021-b1d2-c7357791be13"],
Cell[20082, 608, 967, 32, 166, "Input",ExpressionUUID->"8330c43b-4e55-4c23-bb27-e658a7e66e49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21086, 645, 92, 0, 67, "Section",ExpressionUUID->"b0aef000-fd17-457f-9bfa-f45b2360b5a2"],
Cell[21181, 647, 1509, 43, 73, "Input",ExpressionUUID->"829588c5-8262-4002-9799-3bef3940b580"],
Cell[22693, 692, 11742, 326, 595, "Input",ExpressionUUID->"3b023b5c-1a3b-4f58-bba0-bed4fbb796d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34472, 1023, 81, 0, 67, "Section",ExpressionUUID->"4910ecc9-7d52-45df-b262-b0f8b174eb2c"],
Cell[34556, 1025, 2368, 75, 159, "Input",ExpressionUUID->"78d6985f-f23b-4dc4-b9da-7da5968dd344"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36961, 1105, 84, 0, 67, "Section",ExpressionUUID->"ad09bb25-39da-40f2-ad30-5d56cfd05fe4"],
Cell[37048, 1107, 6039, 181, 432, "Input",ExpressionUUID->"0bcafeda-ba2b-4bb2-b284-13a426ca809c"],
Cell[43090, 1290, 156, 3, 30, "Input",ExpressionUUID->"1ce70016-49cd-4a23-9309-21064334b28e"]
}, Open  ]]
}
]
*)

